<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon"
        href="data:image/png;base64,AAABAAQAMDAAAAEAGACoHAAARgAAACAgAAABABgAqAwAAO4cAAAYGAAAAQAYAEgHAACWKQAAEBAAAAEAGABoAwAA3jAAACgAAAAwAAAAYAAAAAEAGAAAAAAAgBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADc3NzZ2dne3t7b29vg4ODi4uLf39/i4uLi4uLi4uLf39/c3Nzb29sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADZ2dnc3Nzs7Oz29vb////////////////////////////////////////////8/Pzs7OzW1tbb29sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADb29vc3Nzy8vL////////79vHu3Mbq1Lfduo3ZsX7UqHDly6nq1Lf27uL////////////////////////o6Ojb29sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADY2Njl5eX////////hwpu/fSi7dRu7dRu7dRvUqHDy5dT////////////////////////////////////ZsX779vHs7OzY2NgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADb29v29vb////27uLMl1O7dRu7dRu7dRvUqHD27uL////////////////////////////////////////////QoGLUqHD////s7Oza2toAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADY2Nj29vb////duo2/fSi7dRu7dRvUqHD27uL////////////////////////////////////u3Ma8nZaGYoJdQZl0SW25lYr////////5+fnd3d0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADY2Nj29vb79vHIjkW7dRu7dRvDhjfu3Mb///////////////////////////////////////////9nSJEtHr4tHr4tHr4tHr4tHr5HOcawquf////////i4uLc3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADb29v8/Pz79vHIjkW7dRu7dRvZsX779vH////////////////////////////////////////////////l4/ctHr4tHr4tHr4tHr4tHr4tHr4tHr5HOcbKx+/////s7Oza2toAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADY2Nj8/Pz27uK/fSi7dRu/fSjq1Lf////////////////////////////////d1N2dhKh+X5B8Wol8Wol8WolALbEtHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr6IgNr////29vbY2NgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADZ2dny8vL79vHIjkW7dRvDhjfy5dT////////////////////////////u3MbGmGhHLqAtHr4tHr4tHr4tHr4tHr4tHr5CMbhfUcdhVs45K8ItHr4tHr4tHr4tHr4tHr4tHr57ctb////8/Pzc3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADi4uL////QoGK7dRvIjkX79vH////////////////////////27uLUqHC7dRt0SW0tHr4tHr4tHr4tHr4tHr45K8Kwqufl4/eWjt6wqufKx++jnOJHOcYtHr4tHr4tHr4tHr4tHr5uZNL////l5eUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADb29v8/Pzq1Le7dRvIjkX79vH////////////////////////ly6m/fSi7dRuycCU1I7QtHr4tHr4tHr4tHr45K8LX1fOIgNotHr4tHr4tHr4tHr5HOcbKx++Wjt4tHr4tHr4tHr4tHr7X1fP8/Pzb29sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADY2Njs7Oz79vHDhjfIjkX79vH////////////////////////UqHC7dRu7dRu7dRt9T2MtHr4tHr4tHr4tHr4tHr7Kx++IgNotHr4tHr4tHr4tHr4tHr4tHr45K8Ly8fvX1fM5K8ItHr6wquf////m5uYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADb29v////duo2/fSj27uL////////////////////79vHIjkW7dRu7dRu7dRu7dRtHLqAtHr4tHr4tHr4tHr5uZNLKx+8tHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr5HOcZhVs5HOcZhVs7l4/f////5+fnX19cAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADl5eX79vG/fSju3Mb////////////////////79vHIjkW7dRu7dRu7dRu7dRuycCUtHr4tHr4tHr4tHr4tHr7Kx+9hVs4tHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr45K8K9uOv////s7OzY2NgAAAAAAAAAAAAAAAAAAAAAAAAAAADd3d35+fnhwpvduo3////////////////////////QoGK7dRu7dRu7dRu7dRu7dRuXX0QtHr4tHr4tHr4tHr5ENb/y8fstHr4tHr4tHr4tHr4tHr6jnOKjnOItHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr7Kx+/////d3d0AAAAAAAAAAAAAAAAAAAAAAAAAAADd3d3////ZsX7////////////////////////hwpu7dRu7dRu7dRu7dRu7dRu7dRuXX0QtHr4tHr4tHr4tHr6Eec6wquctHr4tHr4tHr4tHr5HOcb///97ctYtHr4tHr4tHr4tHr4tHr4tHr4tHr4tHr5hVs7////g4OAAAAAAAAAAAAAAAAAAAAAAAAAAAADh4eH////q1Lf////////////////////y5dS7dRu7dRu7dRu7dRu7dRu7dRu7dRuXX0QtHr4tHr4tHr4tHr6Wjt6Wjt4tHr4tHr4tHr4tHr6wqufy8fs5K8ItHr4tHr4tHr4tHr5HOcYtHr4tHr4tHr4tHr7X1fPm5uYAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAADb29vb29vh4eHg4ODm5ubm5ubk5OTc3Nzd3d0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADb29v8/Pzy5dS/fSi7dRu7dRvu3Mb////////////////////////i4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADZ2dns7Oz79vG/fSi7dRu/fSjhwpv////////////////////////////i4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADb29v////ZsX67dRvDhjf27uL////////////////////////////////f398AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADl5eX////Dhje7dRvduo3y5dS/fSjly6n////////////////////////i4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADy8vL///+7dRu7dRvIjkW/fSi7dRvly6n////////////////////////c3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADi4uLy8vLu3Ma7dRu7dRu7dRu7dRu7dRvq1Lf////////////////////////f39/Z2dkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAABwAA8AAAAAAHAAD4AAAAAA8AAPgAAAAADwAA/AAAAAAfAAD+AAAAAD8AAP4AB4AAfwAA/AAfwAD/AAD8AB/4A/8AAPgAH////wAA8AAf////AADwAB////8AAPAAH////wAA8AAf////AADgAA////8AAOAAB////wAA8AAD////AADwAAH///8AAPAAAP///wAA+AAA////AAD4AAB///8AAPwAAH///wAA/wAAf///AAD/xgD///8AAP//AP///wAA///B////AAAoAAAAIAAAAEAAAAABABgAAAAAAIAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8fHx8vLy8vLy8vLy8vLy8vLy8vLy8vLy8PDw8vLyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8vLy/Pz88uXU7tzG4cKb3bqN2bF+6tS38uXU/////////////Pz88fHxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8vLy+/bx2bF+u3Ubu3Ub1Khw8uXU////////////////////+/bx0KBi////8vLyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9vb26tS3w4Y3u3UbzJdT9u7i////////////////////6eHgqoWEZ0iRfU9j2czR////7e3tAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+fn52bF+u3Ubv30o6tS3////////////////////////////tKfNLR6+LR6+LR6+LR6+RznGysfv9vb2AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/Pz81Khwu3UbzJdT+/bx////////////////6eHgnYSohWymgGOXTTu1LR6+LR6+LR6+LR6+LR6+LR6+iIDa+fn58fHxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9vb24cKbu3Ub1Khw////////////////9u7i1KhwYj6BLR6+LR6+LR6+OCm+dmjGlo7ee3LWOSvCLR6+LR6+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"
        type="image/png">

    <title>Editor de Polígonos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf_viewer.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #toolbar {
            background-color: #f0f0f0;
            padding: 10px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        #main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        #pdf-container {
            flex: 1;
            position: relative;
            overflow: auto;
            border: 1px solid #ccc;
        }

        #pdf-viewer {
            position: relative;
        }

        .pdf-page {
            position: relative;
            margin: 0 auto;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }

        .rectangle {
            position: absolute;
            border: 2px solid red;
            background-color: rgba(255, 0, 0, 0.2);
            cursor: move;
            box-sizing: border-box;
        }

        .rectangle:hover .rectangle-label {
            display: block;
        }

        .rectangle-label {
            display: none;
            position: absolute;
            background-color: #333;
            color: #fff;
            padding: 4px 8px;
            border-radius: 5px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 10;
            transform: translateY(-100%);
            margin-bottom: 4px;
        }

        .delete-rect-btn {
            background: transparent;
            border: none;
            color: #fff;
            margin-left: 8px;
            cursor: pointer;
            font-size: 12px;
        }

        #output-container {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            background-color: #f0f0f0;
            border-top: 1px solid #ccc;
        }

        #output {
            width: 100%;
            height: 50px;
            margin-top: 5px;
            resize: vertical;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            border-radius: 5px;
        }

        .modal-content h3 {
            margin-top: 0;
        }

        .modal-content label {
            display: block;
            margin-top: 10px;
        }

        .modal-content input {
            width: 100%;
            padding: 5px;
            margin-top: 5px;
            box-sizing: border-box;
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 15px;
            gap: 10px;
        }

        .modal-buttons button {
            padding: 5px 10px;
        }

        button {
            padding: 5px 10px;
            cursor: pointer;
        }

        #page-controls {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #page-num {
            min-width: 30px;
            text-align: center;
        }


        select,
        input[type="number"] {
            width: 100%;
            padding: 7px;
            font-size: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        label {
            margin-top: 10px;
            display: block;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div id="toolbar">
        <input type="file" id="pdf-input" accept=".pdf">
        <button id="add-rectangle-btn">Adicionar Retângulo (Shift+Click)</button>
        <button id="generate-output-btn">Gerar Saída</button>
        <button id="load-data-btn">Carregar Dados</button>
        <button id="clear-rectangles-btn">Limpar Retângulos</button>

        <div>
            Zoom:
            <button id="zoom-out">-</button>
            <span id="zoom-level">100%</span>
            <button id="zoom-in">+</button>
        </div>
        <div id="page-controls">
            <button id="prev-page">Anterior</button>
            <span id="page-num">0</span>/<span id="page-count">0</span>
            <button id="next-page">Próxima</button>
        </div>
    </div>

    <div id="main-container">
        <div id="pdf-container">
            <div id="pdf-viewer"></div>
        </div>
    </div>

    <div id="output-container">
        <label for="output">Coordenadas dos Polígonos:</label>
        <textarea id="output" readonly></textarea>
    </div>

    <div id="rectangle-modal" class="modal">
        <div class="modal-content">
            <h3>Configurar Retângulo</h3>

            <label for="rectangle-type">Tipo do campo:</label>
            <select id="rectangle-type">
                <option value="textual">Textual</option>
                <option value="barcode">Código de Barras</option>
            </select>

            <label for="rectangle-name">Nome:</label>
            <select id="rectangle-name">
                <option value="aceiteBoleto">aceiteBoleto</option>
                <option value="agenciaCedente">agenciaCedente</option>
                <option value="agenciaCodigoBeneficiarioBoleto">agenciaCodigoBeneficiarioBoleto</option>
                <option value="apresentante">apresentante</option>
                <option value="ApontamentoData">ApontamentoData</option>
                <option value="ApontamentoFolha">ApontamentoFolha</option>
                <option value="ApontamentoLivro">ApontamentoLivro</option>
                <option value="ApontamentoOrdem">ApontamentoOrdem</option>
                <option value="avisoDeProtesto">avisoDeProtesto</option>
                <option value="bairro">bairro</option>
                <option value="bairroPagador">bairroPagador</option>
                <option value="BeneficiarioBoleto">BeneficiarioBoleto</option>
                <option value="carteiraBoleto">carteiraBoleto</option>
                <option value="cep">cep</option>
                <option value="cepPagador">cepPagador</option>
                <option value="cidade">cidade</option>
                <option value="cidadePagador">cidadePagador</option>
                <option value="codPortador">codPortador</option>
                <option value="codigoBarrasBoleto">codigoBarrasBoleto</option>
                <option value="complemento">complemento</option>
                <option value="conta">conta</option>
                <option value="CpfCnpjBeneficiario">CpfCnpjBeneficiario</option>
                <option value="CpfCnpjBeneficiarioBoleto">CpfCnpjBeneficiarioBoleto</option>
                <option value="cpfCnpjPagador">cpfCnpjPagador</option>
                <option value="descricao">descricao</option>
                <option value="descontoBoleto">descontoBoleto</option>
                <option value="email">email</option>
                <option value="endereço">endereço</option>
                <option value="enderecoPagador">enderecoPagador</option>
                <option value="Endosso">Endosso</option>
                <option value="especie">especie</option>
                <option value="especieBoleto">especieBoleto</option>
                <option value="especieBoleto2">especieBoleto2</option>
                <option value="estado">estado</option>
                <option value="estadoPagador">estadoPagador</option>
                <option value="FinsFalimentares">FinsFalimentares</option>
                <option value="horarioAtendimento">horarioAtendimento</option>
                <option value="instrucoesBoleto">instrucoesBoleto</option>
                <option value="LayoutImpressao">LayoutImpressao</option>
                <option value="linhaCabecalho">linhaCabecalho</option>
                <option value="linhaDigitavelBoleto">linhaDigitavelBoleto</option>
                <option value="localPagamento">localPagamento</option>
                <option value="moraMultaJurosBoleto">moraMultaJurosBoleto</option>
                <option value="MotivoIntimacao">MotivoIntimacao</option>
                <option value="nome">nome</option>
                <option value="nomeBeneficiario">nomeBeneficiario</option>
                <option value="nomeEndossante">nomeEndossante</option>
                <option value="nomePagador">nomePagador</option>
                <option value="nomeTransportadora">nomeTransportadora</option>
                <option value="nossoNumero">nossoNumero</option>
                <option value="nossoNumeroBoleto">nossoNumeroBoleto</option>
                <option value="numeroBanco">numeroBanco</option>
                <option value="numeroBancoBoleto">numeroBancoBoleto</option>
                <option value="numeroDocumentoBoleto">numeroDocumentoBoleto</option>
                <option value="numeroTitulo">numeroTitulo</option>
                <option value="ObservacaoDestino">ObservacaoDestino</option>
                <option value="outraDeducoesBoleto">outraDeducoesBoleto</option>
                <option value="posPagamento">posPagamento</option>
                <option value="prazoPagamento">prazoPagamento</option>
                <option value="protocolo">protocolo</option>
                <option value="protocoloDistribuidor">protocoloDistribuidor</option>
                <option value="QrCode">QrCode</option>
                <option value="QRCodePix">QRCodePix</option>
                <option value="quantidadeBoleto">quantidadeBoleto</option>
                <option value="RotaID">RotaID</option>
                <option value="seloDigital">seloDigital</option>
                <option value="telefone">telefone</option>
                <option value="TextoAviso">TextoAviso</option>
                <option value="valorApontamento">valorApontamento</option>
                <option value="valorBoleto">valorBoleto</option>
                <option value="valorCertidao">valorCertidao</option>
                <option value="valorCobradoBoleto">valorCobradoBoleto</option>
                <option value="valorCustasTab">valorCustasTab</option>
                <option value="valorDiligencia">valorDiligencia</option>
                <option value="valorEmolumentos">valorEmolumentos</option>
                <option value="valorEntrega">valorEntrega</option>
                <option value="valorFunajuris">valorFunajuris</option>
                <option value="ValorFundpam">ValorFundpam</option>
                <option value="ValorFundpge">ValorFundpge</option>
                <option value="ValorFunjeamExtrajudicial">ValorFunjeamExtrajudicial</option>
                <option value="ValorFunjeamRcpn">ValorFunjeamRcpn</option>
                <option value="valorIntimacao">valorIntimacao</option>
                <option value="valorISSQN">valorISSQN</option>
                <option value="valorPrincipal">valorPrincipal</option>
                <option value="ValorRegistroCivil">ValorRegistroCivil</option>
                <option value="ValorSaldoTitulo">ValorSaldoTitulo</option>
                <option value="ValorSDT">ValorSDT</option>
                <option value="ValorSelo">ValorSelo</option>
                <option value="valorTarifaBanco">valorTarifaBanco</option>
                <option value="valorTotal">valorTotal</option>
                <option value="ValorSubTotal">ValorSubTotal</option>
                <option value="vencimentoTitulo">vencimentoTitulo</option>
                <option value="carteiraBoleto">carteiraBoleto</option>
                <option value="CampoLivre1">CampoLivre1</option>
                <option value="CampoLivre2">CampoLivre2</option>
                <option value="CodBarraCliente">CodBarraCliente</option>
            </select>

            <label for="rectangle-page">Página:</label>
            <input type="number" id="rectangle-page" min="1" value="1">

            <div class="modal-buttons">
                <button id="cancel-rectangle-btn">Cancelar</button>
                <button id="save-rectangle-btn">Salvar</button>
            </div>
        </div>
    </div>

    <div id="load-modal" class="modal">
        <div class="modal-content">
            <h3>Carregar Dados</h3>
            <textarea id="load-data-input" style="width: 100%; height: 100px;"></textarea>
            <div class="modal-buttons">
                <button id="cancel-load-btn">Cancelar</button>
                <button id="confirm-load-btn">Carregar</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js"></script>
    <script>
        // Configuração do PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        let pdfDoc = null;
        let currentPage = 1;
        let pageRendering = false;
        let pageNumPending = null;
        let scale = 1.0;
        let isAddingRectangle = false;
        let startPoint = null;
        let currentRectangle = null;
        let rectangles = [];
        let pdfContainer = document.getElementById('pdf-container');
        let pdfViewer = document.getElementById('pdf-viewer');
        let shiftPressed = false;
        let pageSizes = {};
        let startYValues = {};

        // Elementos da UI
        const pdfInput = document.getElementById('pdf-input');
        const addRectangleBtn = document.getElementById('add-rectangle-btn');
        const generateOutputBtn = document.getElementById('generate-output-btn');
        const loadDataBtn = document.getElementById('load-data-btn');
        const clearRectanglesBtn = document.getElementById('clear-rectangles-btn');
        const zoomInBtn = document.getElementById('zoom-in');
        const zoomOutBtn = document.getElementById('zoom-out');
        const zoomLevelSpan = document.getElementById('zoom-level');
        const outputTextarea = document.getElementById('output');
        const prevPageBtn = document.getElementById('prev-page');
        const nextPageBtn = document.getElementById('next-page');
        const pageNumSpan = document.getElementById('page-num');
        const pageCountSpan = document.getElementById('page-count');

        // Modal elements
        const rectangleModal = document.getElementById('rectangle-modal');
        const rectangleNameInput = document.getElementById('rectangle-name');
        const typeSelect = document.getElementById('rectangle-type');
        const rectanglePageInput = document.getElementById('rectangle-page');
        const saveRectangleBtn = document.getElementById('save-rectangle-btn');
        const cancelRectangleBtn = document.getElementById('cancel-rectangle-btn');
        const loadModal = document.getElementById('load-modal');
        const loadDataInput = document.getElementById('load-data-input');
        const confirmLoadBtn = document.getElementById('confirm-load-btn');
        const cancelLoadBtn = document.getElementById('cancel-load-btn');

        // Event Listeners
        pdfInput.addEventListener('change', openPDF);
        addRectangleBtn.addEventListener('click', toggleRectangleMode);
        generateOutputBtn.addEventListener('click', generateOutput);
        loadDataBtn.addEventListener('click', showLoadModal);
        clearRectanglesBtn.addEventListener('click', clearAllRectangles);
        zoomInBtn.addEventListener('click', () => zoomPDF(0.1));
        zoomOutBtn.addEventListener('click', () => zoomPDF(-0.1));
        saveRectangleBtn.addEventListener('click', saveRectangle);
        cancelRectangleBtn.addEventListener('click', cancelRectangle);
        confirmLoadBtn.addEventListener('click', loadData);
        cancelLoadBtn.addEventListener('click', () => loadModal.style.display = 'none');
        prevPageBtn.addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                queueRenderPage(currentPage);
            }
        });
        nextPageBtn.addEventListener('click', () => {
            if (pdfDoc && currentPage < pdfDoc.numPages) {
                currentPage++;
                queueRenderPage(currentPage);
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Shift') {
                shiftPressed = true;
            }

            if (e.ctrlKey && (e.key === '+' || e.key === '=')) {
                e.preventDefault();
                zoomPDF(0.1);
            } else if (e.ctrlKey && e.key === '-') {
                e.preventDefault();
                zoomPDF(-0.1);
            }
        });

        document.addEventListener('wheel', (e) => {
            if (e.ctrlKey) {
                e.preventDefault(); // Bloqueia zoom nativo do navegador

                const delta = Math.sign(e.deltaY);
                if (delta < 0) {
                    zoomPDF(0.1);  // Scroll para cima → zoom in
                } else if (delta > 0) {
                    zoomPDF(-0.1); // Scroll para baixo → zoom out
                }
            }
        }, { passive: false });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'Shift') {
                shiftPressed = false;
            }
        });

        // PDF Viewer functions
        function openPDF(e) {
            const file = e.target.files[0];
            if (!file) return;

            // Reset state
            rectangles = [];
            pageSizes = {};
            startYValues = {};
            outputTextarea.value = '';

            const fileReader = new FileReader();

            fileReader.onload = function () {
                const typedArray = new Uint8Array(this.result);

                pdfjsLib.getDocument(typedArray).promise.then(function (pdf) {
                    pdfDoc = pdf;
                    pageCountSpan.textContent = pdf.numPages;
                    currentPage = 1;
                    pageNumSpan.textContent = currentPage;

                    // Calculate startY for all pages
                    calculateStartYFirstPage(pdf).then(() => {
                        renderPage(currentPage);
                    });
                }).catch(function (error) {
                    console.error('Error loading PDF:', error);
                    alert('Erro ao carregar o PDF: ' + error.message);
                });
            };

            fileReader.readAsArrayBuffer(file);
        }

        function clearAllRectangles() {
            rectangles.forEach(r => {
                if (r.element && r.element.parentNode) {
                    r.element.parentNode.removeChild(r.element);
                }
            });
            rectangles = []; // Limpa a lista
            outputTextarea.value = ''; // Limpa a saída, se desejar

            // 🔄 Reabilita todos os <option> do select de nomes
            [...rectangleNameInput.options].forEach(option => {
                option.disabled = false;
            });

            // Reseta o select para o valor padrão
            rectangleNameInput.selectedIndex = 0;
        }

        async function calculateStartYFirstPage(pdf) {
            const page = await pdf.getPage(1);
            const viewport = page.getViewport({ scale: 1.0 });
            const textContent = await page.getTextContent();

            const width = viewport.width;
            const height = viewport.height;

            function hasTextInRect(top, bottom, left = 0, right = width) {
                return textContent.items.some(item => {
                    const x = item.transform[4];
                    const y = item.transform[5];
                    const h = item.height || 0;
                    const w = item.width || 0;

                    const itemTop = y + h;
                    const itemBottom = y;

                    const verticalOverlap = !(itemBottom > bottom || itemTop < top);
                    const horizontalOverlap = !(x + w < left || x > right);

                    const text = item.str?.trim();
                    if (!text || text.length < 2 || h < 5) return false;

                    return verticalOverlap && horizontalOverlap;
                });
            }

            let low = 0;
            let high = height;
            const stepSize = 10;

            // Busca ternária
            while ((high - low) > stepSize) {
                const mid1 = low + (high - low) / 3;
                const mid2 = high - (high - low) / 3;

                const rect1Top = height - mid1;
                const rect1Bottom = height;

                const rect2Top = height - mid2;
                const rect2Bottom = height - mid1;

                const rect3Top = height - high;
                const rect3Bottom = height - mid2;

                if (hasTextInRect(rect1Top, rect1Bottom)) {
                    high = mid1;
                } else if (hasTextInRect(rect2Top, rect2Bottom)) {
                    low = mid1;
                    high = mid2;
                } else if (hasTextInRect(rect3Top, rect3Bottom)) {
                    low = mid2;
                } else {
                    low = mid1;
                    high = mid2;
                }
            }

            // Busca binária para refinar
            while ((high - low) > 1) {
                const mid = (low + high) / 2;

                const midTop = height - mid;
                const midBottom = height - low;

                if (hasTextInRect(midTop, midBottom)) {
                    high = mid;
                } else {
                    low = mid;
                }
            }

            startYValues[1] = height - high;
        }

        function renderPage(num) {
            pageRendering = true;

            pdfDoc.getPage(num).then(function (page) {
                const viewport = page.getViewport({ scale: scale });
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.className = 'pdf-page';

                canvas.height = viewport.height;
                canvas.width = viewport.width;

                // Adjust canvas display size to maintain aspect ratio
                canvas.style.height = `${viewport.height}px`;
                canvas.style.width = `${viewport.width}px`;

                pdfViewer.innerHTML = '';
                pdfViewer.appendChild(canvas);
                pdfViewer.style.width = `${viewport.width}px`;
                pdfViewer.style.height = `${viewport.height}px`;

                const renderContext = {
                    canvasContext: context,
                    viewport: viewport
                };

                const renderTask = page.render(renderContext);

                renderTask.promise.then(function () {
                    pageRendering = false;
                    if (pageNumPending !== null) {
                        renderPage(pageNumPending);
                        pageNumPending = null;
                    }

                    // Redraw rectangles after page is rendered
                    redrawRectangles();
                });
            });

            pageNumSpan.textContent = num;
        }

        function saveRectangle() {
            const name = rectangleNameInput.value;
            const page = rectanglePageInput.value;
            if (!name) {
                alert('Por favor, informe o nome do retângulo.');
                return;
            }

            // Fechar modal e limpar inputs
            rectangleModal.style.display = 'none';

        }



        function zoomPDF(zoomDelta) {
            scale += zoomDelta;
            if (scale < 0.5) scale = 0.5;
            if (scale > 3) scale = 3;

            zoomLevelSpan.textContent = `${Math.round(scale * 100)}%`;

            if (pdfDoc) {
                queueRenderPage(currentPage);
            }
        }

        function queueRenderPage(num) {
            if (pageRendering) {
                pageNumPending = num;
            } else {
                renderPage(num);
            }
        }

        // Rectangle functions
        function toggleRectangleMode() {
            isAddingRectangle = !isAddingRectangle;
            addRectangleBtn.textContent = isAddingRectangle ?
                'Modo Retângulo Ativo (Shift+Click)' :
                'Adicionar Retângulo (Shift+Click)';
            addRectangleBtn.style.backgroundColor = isAddingRectangle ? '#d4edda' : '';
        }

        function startRectangle(e) {
            if ((!isAddingRectangle && !shiftPressed) || e.button !== 0) return;

            e.preventDefault();
            e.stopPropagation();

            const rect = pdfViewer.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            startPoint = { x, y };

            currentRectangle = document.createElement('div');
            currentRectangle.className = 'rectangle';
            currentRectangle.style.left = `${x}px`;
            currentRectangle.style.top = `${y}px`;
            currentRectangle.style.width = '0';
            currentRectangle.style.height = '0';

            pdfViewer.appendChild(currentRectangle);

            document.addEventListener('mousemove', resizeRectangle);
            document.addEventListener('mouseup', endRectangle);
        }

        function resizeRectangle(e) {
            if (!currentRectangle) return;

            const rect = pdfViewer.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const width = x - startPoint.x;
            const height = y - startPoint.y;

            currentRectangle.style.left = `${Math.min(x, startPoint.x)}px`;
            currentRectangle.style.top = `${Math.min(y, startPoint.y)}px`;
            currentRectangle.style.width = `${Math.abs(width)}px`;
            currentRectangle.style.height = `${Math.abs(height)}px`;
        }

        function endRectangle(e) {
            if (!currentRectangle || e.button !== 0) return;

            document.removeEventListener('mousemove', resizeRectangle);
            document.removeEventListener('mouseup', endRectangle);

            const rect = currentRectangle.getBoundingClientRect();
            const viewerRect = pdfViewer.getBoundingClientRect();

            // Check if the rectangle has significant size
            if (rect.width < 5 || rect.height < 5) {
                currentRectangle.remove();
                currentRectangle = null;
                return;
            }


            // Show modal to get rectangle name and page number
            rectangleModal.style.display = 'block';
            rectangleNameInput.value = `Retângulo ${rectangles.length + 1}`;
            rectanglePageInput.value = currentPage;
            rectangleNameInput.focus();

            // Clear previous event listeners to avoid duplicates
            saveRectangleBtn.onclick = null;
            saveRectangleBtn.onclick = function () {
                saveCurrentRectangle(rect, viewerRect);
            };
        }

        function saveCurrentRectangle(rect, viewerRect) {
            const pageRaw = rectanglePageInput.value;
            const page = parseInt(pageRaw);
            const type = typeSelect.value;
            const nameBase = rectangleNameInput.value;

            if (!nameBase) {
                alert('Por favor, insira um nome para o retângulo.');
                return;
            }

            let name = (type === 'barcode') ? nameBase + '_BARCODE' : nameBase;


            if (isNaN(page) || page < 1 || page > pdfDoc.numPages) {
                alert('Número de página inválido.');
                return;
            }

            // Calcular coordenadas relativas
            const x = (rect.left - viewerRect.left) / scale;
            const y = (rect.top - viewerRect.top) / scale;
            const width = rect.width / scale;
            const height = rect.height / scale;

            const label = document.createElement('div');
            label.className = 'rectangle-label';
            label.textContent = `${name} (Pág. ${page})`;
            label.style.left = currentRectangle.style.left;
            label.style.top = `${parseFloat(currentRectangle.style.top) - 20}px`;

            currentRectangle.appendChild(label);

            rectangles.push({
                element: currentRectangle,
                name,
                page,
                x,
                y,
                width,
                height
            });

            makeDraggable(currentRectangle);

            rectangleModal.style.display = 'none';
            rectangleNameInput.value = '';
            rectanglePageInput.value = '';
            currentRectangle = null;

            // 🔒 Desabilita a opção do nome-base (sem _BARCODE)
            const nameOption = [...rectangleNameInput.options].find(opt => opt.value === nameBase);
            if (nameOption) nameOption.disabled = true;

            // Reseta o select
            rectangleNameInput.selectedIndex = 0;

        }


        function cancelRectangle() {
            if (currentRectangle) {
                currentRectangle.remove();
                currentRectangle = null;
            }
            rectangleModal.style.display = 'none';
        }

        function makeDraggable(element) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            let isDragging = false;

            const dragMouseDown = (e) => {
                if (e.button !== 0 || (e.target !== element && e.target.className !== 'rectangle-label')) return;

                e.preventDefault();
                e.stopPropagation();

                // Get the mouse cursor position at startup
                pos3 = e.clientX;
                pos4 = e.clientY;

                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            };

            const elementDrag = (e) => {
                e.preventDefault();
                e.stopPropagation();

                // Calculate the new cursor position
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;

                // Set the element's new position
                element.style.top = (element.offsetTop - pos2) + 'px';
                element.style.left = (element.offsetLeft - pos1) + 'px';

                // Update the label position
                const label = element.querySelector('.rectangle-label');
                if (label) {
                    label.style.top = (parseFloat(element.style.top) - 20) + 'px';
                    label.style.left = element.style.left;
                }

                isDragging = true;
            };

            const closeDragElement = () => {
                // Stop moving when mouse button is released
                document.onmouseup = null;
                document.onmousemove = null;

                if (isDragging) {
                    // Update rectangle data in the array
                    const rect = element.getBoundingClientRect();
                    const viewerRect = pdfViewer.getBoundingClientRect();

                    const index = rectangles.findIndex(r => r.element === element);
                    if (index !== -1) {
                        rectangles[index].x = (rect.left - viewerRect.left) / scale;
                        rectangles[index].y = (rect.top - viewerRect.top) / scale;
                    }

                    isDragging = false;
                }
            };

            element.onmousedown = dragMouseDown;
        }

        function redrawRectangles() {
            if (!pdfDoc) return;

            // Remove todos os retângulos existentes
            const existingRects = document.querySelectorAll('.rectangle');
            existingRects.forEach(rect => {
                if (rect !== currentRectangle) {
                    rect.remove();
                }
            });

            // Redesenha todos os retângulos da página atual
            rectangles.forEach((rectData, index) => {
                if (rectData.page !== currentPage) return;

                const rect = document.createElement('div');
                rect.className = 'rectangle';
                rect.style.left = `${rectData.x * scale}px`;
                rect.style.top = `${rectData.y * scale}px`;
                rect.style.width = `${rectData.width * scale}px`;
                rect.style.height = `${rectData.height * scale}px`;

                // Tooltip flutuante (label)
                const label = document.createElement('div');
                label.className = 'rectangle-label';
                label.textContent = `${rectData.name} (Pág. ${rectData.page})`;

                // Botão de excluir
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-rect-btn';
                deleteBtn.textContent = 'Excluir';
                deleteBtn.onclick = () => {
                    rectangles.splice(index, 1); // Remove da lista

                    // ♻️ Reabilita a opção do select
                    const cleanName = rectData.name.replace('_BARCODE', '');
                    const optionToEnable = [...rectangleNameInput.options].find(opt => opt.value === cleanName);
                    if (optionToEnable) optionToEnable.disabled = false;

                    redrawRectangles();         // Atualiza tela
                };

                label.appendChild(deleteBtn);
                rect.appendChild(label);
                pdfViewer.appendChild(rect);

                // Guarda referência do DOM
                rectData.element = rect;

                // Tooltip aparece só no hover
                rect.addEventListener('mouseenter', () => {
                    label.style.display = 'block';
                });
                rect.addEventListener('mouseleave', () => {
                    label.style.display = 'none';
                });

                makeDraggable(rect);
            });
        }



        function generateOutput() {
            if (!pdfDoc || rectangles.length === 0) {
                outputTextarea.value = 'Nenhum retângulo definido.';
                return;
            }

            let output = '';

            // Adiciona apenas a altura da página 1
            const startY1 = startYValues[1] || startYValues["1"];
            if (startY1 !== undefined) {
                output += `AlturaPagina:${startY1.toFixed(2)};`;
            }

            // Adiciona todos os retângulos, independentemente da página
            rectangles.forEach(rect => {
                output += `${rect.name}:` +
                    `${rect.x.toFixed(2)},` +
                    `${rect.y.toFixed(2)},` +
                    `${rect.width.toFixed(2)},` +
                    `${rect.height.toFixed(2)},` +
                    `${rect.page};`;
            });

            outputTextarea.value = output;
        }

        function showLoadModal() {
            loadModal.style.display = 'block';
            loadDataInput.focus();
        }

        function loadData() {
            const input = loadDataInput.value.trim();
            if (!input) {
                alert('Por favor, insira os dados para carregar.');
                return;
            }

            try {
                rectangles = [];
                startYValues = {};

                // Parse the input string
                const parts = input.split(';').filter(part => part.trim() !== '');

                parts.forEach(part => {
                    if (part.startsWith('AlturaPagina')) {
                        // Parse page height information
                        const pageMatch = part.match(/AlturaPagina(\d*):(.+)/);
                        if (pageMatch && pageMatch.length >= 3) {
                            const page = pageMatch[1] || '1'; // Default to page 1 if no number
                            const startY = parseFloat(pageMatch[2]);
                            startYValues[page] = startY;
                        }
                        return;
                    }

                    const [name, coords] = part.split(':');
                    if (!name || !coords) return;

                    const [x, y, width, height, page] = coords.split(',');

                    rectangles.push({
                        name: name.trim(),
                        x: parseFloat(x),
                        y: parseFloat(y),
                        width: parseFloat(width),
                        height: parseFloat(height),
                        page: parseInt(page),
                        element: null // Will be set in redrawRectangles
                    });

                    // desabilita opcoes no select baseado nos nomes importados
                    const cleanName = name.replace('_BARCODE', '');
                    const optionToEnable = [...rectangleNameInput.options].find(opt => opt.value === cleanName);
                    if (optionToEnable) optionToEnable.disabled = true;
                });
                rectangleNameInput.selectedIndex = 0;

                // Redraw rectangles for current page
                redrawRectangles();
                loadModal.style.display = 'none';
                loadDataInput.value = '';



                alert(`Foram carregados ${rectangles.length} retângulos.`);
            } catch (e) {
                alert(`Erro ao processar os dados: ${e.message}`);
            }
        }

        // Initialize event listeners
        pdfViewer.addEventListener('mousedown', startRectangle);

        // Prevent text selection when dragging
        document.addEventListener('selectstart', (e) => {
            if (currentRectangle || rectangles.some(rect => rect.element && rect.element.contains(e.target))) {
                e.preventDefault();
            }
        });
    </script>
</body>

</html>